# Numerical-Simulation-and-Parameter-Inference-for-the-Diffusion-Equation
Overview

This project implements a numerical forwardâ€“inverse modeling pipeline for the 1D diffusion equation.
The goal is not just to simulate diffusion, but to estimate the diffusion coefficient from noisy observations using a physics-based numerical model.

The project demonstrates:

- finite-difference discretization of a PDE

- stability-aware numerical simulation

- synthetic data generation with noise

- parameter estimation via error minimization

- analysis of limitations inherent to inverse diffusion problems

Mathematical Model

We consider the 1D diffusion equation:

âˆ‚
ğ‘¢
(
ğ‘¥
,
ğ‘¡
)
âˆ‚
ğ‘¡
=
ğ·
âˆ‚
2
ğ‘¢
(
ğ‘¥
,
ğ‘¡
)
âˆ‚
ğ‘¥
2
âˆ‚t
âˆ‚u(x,t)
	â€‹

=D
âˆ‚x
2
âˆ‚
2
u(x,t)
	â€‹


where:

ğ‘¢
(
ğ‘¥
,
ğ‘¡
)
u(x,t) is the diffusing quantity

ğ·
D is the diffusion coefficient (unknown in the inverse problem)

ğ‘¥
âˆˆ
[
0
,
ğ¿
]
xâˆˆ[0,L], 
ğ‘¡
âˆˆ
[
0
,
ğ‘‡
]
tâˆˆ[0,T]

Numerical Method

91 using an explicit finite difference scheme:

- Spatial domain discretized into N
[[[](url)](url)](url)
	â€‹

 grid points

- Time discretized into N
	â€‹

 steps

- Central difference for the second spatial derivative

- Forward difference for the time derivative

The update rule for interior points is:

ğ‘¢
ğ‘–
ğ‘›
+
1
=
ğ‘¢
ğ‘–
ğ‘›
+
ğ‘Ÿ
(
ğ‘¢
ğ‘–
+
1
ğ‘›
âˆ’
2
ğ‘¢
ğ‘–
ğ‘›
+
ğ‘¢
ğ‘–
âˆ’
1
ğ‘›
)
u
i
n+1
	â€‹

=u
i
n
	â€‹

+r(u
i+1
n
	â€‹

âˆ’2u
i
n
	â€‹

+u
iâˆ’1
n
	â€‹

)

where:

ğ‘Ÿ
=
ğ·
Î”
ğ‘¡
Î”
ğ‘¥
2
r=
Î”x
2
DÎ”t
	â€‹

Stability

The explicit scheme requires:

ğ‘Ÿ
â‰¤
0.5
râ‰¤0.5

The solver enforces this condition and raises an error if violated.

Boundary Conditions

No-flux (Neumann) boundary conditions are used:

âˆ‚
ğ‘¢
âˆ‚
ğ‘¥
=
0
at boundaries
âˆ‚x
âˆ‚u
	â€‹

=0at boundaries

Implemented by mirroring the nearest interior values.

Forward Simulation

The forward solver (solver_1d.py) simulates diffusion from an initial localized spike at the center of the domain.

This initial condition is chosen because it:

clearly demonstrates spreading behavior

preserves symmetry

makes numerical issues immediately visible

Synthetic Data Generation

Synthetic observations are generated by:

Running the forward solver with a fixed â€œtrueâ€ diffusion coefficient 
ğ·
true
D
true
	â€‹


Selecting a subset of time steps as observation points

Adding zero-mean Gaussian noise to simulate measurement error

The clean forward model is never corrupted; noise is added only to observed data, reflecting realistic experimental conditions.

The synthetic dataset is saved in NumPy .npz format for reproducibility.

Parameter Estimation (Inverse Problem)

The inverse problem consists of estimating 
ğ·
D from noisy observations.

Approach

Candidate values of 
ğ·
D are sampled within the numerically stable range

For each candidate:

the forward solver is run

simulated profiles at observed times are extracted

a mean squared error (MSE) is computed against observed data

The value of 
ğ·
D minimizing the error is selected

This is a physics-constrained inverse problem, not a machine learning approach.

Results
Estimated Diffusion Coefficient

True diffusion coefficient: 
ğ·
true
=
0.2
D
true
	â€‹

=0.2

Estimated diffusion coefficient: 
ğ·
â‰ˆ
0.209
Dâ‰ˆ0.209

The estimate closely matches the true value despite added noise.

Interpretation

The small discrepancy arises due to:

- measurement noise

- numerical discretization error

- smoothing and ill-conditioning inherent to diffusion

- finite resolution of the parameter search

These effects are expected in inverse diffusion problems.

Plots Included (Demo & Evidence)
1. Diffusion Evolution (Forward Model)

What to show:

- Spatial profiles at selected time steps (e.g. t = 0, 50, 100, 200, 500)

Why it matters:

- Verifies numerical correctness

- Shows spreading, symmetry, and decay

- Demonstrates stable, physical behavior

2. Error vs Diffusion Coefficient

What to show:

Mean squared error as a function of candidate 
ğ·
D

Why it matters:

- This is the core inverse problem result

- Shows identifiability of 
ğ·
D

- Visualizes the effect of noise and model sensitivity

This plot is the key evidence that parameter estimation works.

Limitations

- Explicit finite difference scheme limits time step size due to stability constraints

- Diffusion smooths information, making the inverse problem ill-conditioned at late times

Estimation accuracy degrades with increased noise

- Only 1D diffusion is considered in this implementation

These limitations are intrinsic to the problem and motivate further extensions.

Possible Extensions

- Extension to 2D diffusion

- Implicit or semi-implicit time-stepping schemes

- Finer parameter search or uncertainty quantification

- Application to real experimental or benchmark datasets

Repository Structure
src/
â”œâ”€â”€ solver_1d.py              # Forward diffusion solver
â”œâ”€â”€ generate_data.py          # Synthetic data generation
â”œâ”€â”€ parameter_estimation.py   # Inverse modeling and estimation
plots/
data/
README.md

Final Note

This project focuses on correctness, numerical stability, and interpretability rather than scale or novelty.
It is intended as a demonstration of scientific computing and inverse modeling fundamentals.
